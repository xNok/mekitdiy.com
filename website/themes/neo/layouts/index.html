{{ define "main" }}
<section class="py-12 bg-nb-light-bg">
  <div class="container mx-auto px-6">
    <h1 class="text-4xl font-bold text-nb-light-text text-center mb-2 bg-avocado-300">Welcome to MekitDiY!</h1>
    <p class="text-xl text-nb-light-text text-center mb-12">Your source for awesome DIY projects.</p>

    {{ if .Site.Params.banner.enable }}
    <div class="bg-nb-pop-yellow text-center py-4 my-8 border-2 border-nb-light-border shadow-neo">
      <p class="text-nb-light-text font-semibold">{{ .Site.Params.banner.message }}</p>
    </div>
    {{ end }}

    <!-- Featured Projects Section -->
    <h2 class="text-3xl font-semibold text-nb-light-text text-center my-8">Featured Projects</h2>
    <div class="grid md:grid-cols-2 gap-8 mb-12">
      {{ range first 2 (where .Site.RegularPages "Type" "projects") }}
        <div class="bg-nb-light-bg border-4 border-nb-light-border p-6 shadow-neo">
          <h3 class="text-2xl font-bold text-nb-pop-blue mb-2">{{ .Title }}</h3>
          <p class="text-nb-light-text mb-4">{{ .Summary | truncate 150 }}</p>
          <a href="{{ .RelPermalink }}" class="inline-block bg-nb-pop-pink text-text-on-pop-bright font-semibold py-2 px-4 border-2 border-nb-light-border hover:bg-nb-pop-yellow hover:text-text-on-pop-dark transition-colors">
            Learn More
          </a>
        </div>
      {{ end }}
    </div>
    {{ if gt (len (where .Site.RegularPages "Type" "projects")) 2 }}
      <div class="text-center mb-16">
        <a href="{{ "projects/" | relURL }}" class="bg-nb-pop-blue text-text-on-pop-bright font-semibold py-3 px-6 border-2 border-nb-light-border hover:bg-nb-pop-pink hover:text-text-on-pop-bright transition-colors">
          View All Projects
        </a>
      </div>
    {{ end }}

    <!-- Latest Blog Posts Section -->
    {{ $blogPosts := where .Site.RegularPages "Type" "blog" }}
    {{ if $blogPosts }}
    <h2 class="text-3xl font-semibold text-nb-light-text text-center my-8 mt-16">Latest Articles</h2>
    <div class="grid md:grid-cols-3 gap-6 mb-12">
      {{ range first 3 ($blogPosts.ByDate.Reverse) }}
        <div class="bg-nb-light-bg border-4 border-nb-light-border p-6 shadow-neo">
          <h3 class="text-xl font-bold text-nb-pop-blue mb-2">
            <a href="{{ .RelPermalink }}" class="hover:text-nb-pop-pink">{{ .Title }}</a>
          </h3>
          <p class="text-sm text-nb-light-text mb-3 opacity-75">
            {{ .Date.Format "January 2, 2006" }}
          </p>
          <p class="text-nb-light-text mb-4">{{ .Summary | truncate 100 }}</p>
          <a href="{{ .RelPermalink }}" class="text-nb-pop-pink hover:text-nb-pop-yellow font-semibold">Read More &rarr;</a>
        </div>
      {{ end }}
    </div>
    <div class="text-center mb-16">
      <a href="{{ "blog/" | relURL }}" class="bg-nb-pop-blue text-text-on-pop-bright font-semibold py-3 px-6 border-2 border-nb-light-border hover:bg-nb-pop-pink hover:text-text-on-pop-bright transition-colors">
        View All Articles
      </a>
    </div>
    {{ end }}

    <!-- Gallery Section (Mosaic Layout) -->
    {{ $allPages := union (where .Site.RegularPages "Type" "projects") (where .Site.RegularPages "Type" "blog") }}
    {{ if $allPages }}
    <h2 class="text-3xl font-semibold text-nb-light-text text-center my-8 mt-16">Project Gallery</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
      {{ range first 8 ($allPages.ByDate.Reverse) }}
        <a href="{{ .RelPermalink }}" class="group relative overflow-hidden border-4 border-nb-light-border shadow-neo hover:shadow-neo-hover transition-all bg-gradient-to-br {{ if eq (mod (add 1 .Date.Unix) 4) 0 }}from-nb-pop-pink to-nb-pop-yellow{{ else if eq (mod (add 1 .Date.Unix) 4) 1 }}from-nb-pop-blue to-nb-pop-cyan{{ else if eq (mod (add 1 .Date.Unix) 4) 2 }}from-nb-pop-yellow to-nb-pop-pink{{ else }}from-nb-pop-cyan to-nb-pop-blue{{ end }} aspect-square {{ if eq (mod (add 1 .Date.Unix) 3) 0 }}md:col-span-2 md:row-span-2{{ end }}">
          <div class="absolute inset-0 bg-nb-light-bg bg-opacity-0 group-hover:bg-opacity-90 transition-all flex items-center justify-center p-4">
            <div class="opacity-0 group-hover:opacity-100 transition-opacity text-center">
              <h4 class="text-lg font-bold text-nb-pop-blue mb-1">{{ .Title }}</h4>
              <p class="text-sm text-nb-light-text">{{ if eq .Type "projects" }}Project{{ else }}Article{{ end }}</p>
            </div>
          </div>
        </a>
      {{ end }}
    </div>
    <div class="text-center">
      <a href="{{ "projects/" | relURL }}" class="bg-nb-pop-blue text-text-on-pop-bright font-semibold py-3 px-6 border-2 border-nb-light-border hover:bg-nb-pop-pink hover:text-text-on-pop-bright transition-colors mr-4">
        More Projects
      </a>
      <a href="{{ "blog/" | relURL }}" class="bg-nb-pop-pink text-text-on-pop-bright font-semibold py-3 px-6 border-2 border-nb-light-border hover:bg-nb-pop-yellow hover:text-text-on-pop-dark transition-colors">
        More Articles
      </a>
    </div>
    {{ end }}
  </div>
</section>
{{ end }}